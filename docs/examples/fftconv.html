

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>FFT Convolution &#8212; matx  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/fftconv';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Limitations" href="../limitations.html" />
    <link rel="prev" title="Example Applications" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">matx  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MatX Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Build Integration</a></li>



<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/index.html">Basics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/broadcast.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/concepts.html">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/creation.html">Creating Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/datatype.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/matlabpython.html">MatX For MATLAB/NumPy Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/nvtx.html">NVTX Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/print.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/tensor.html">Tensor Type</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/creation/index.html">Creating Operators and Tensors</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/creation/operators/index.html">Creation Operators</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/alternate.html">alternate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/diag.html">diag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/eye.html">eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/linspace.html">linspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/logspace.html">logspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/meshgrid.html">meshgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/ones.html">ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/range.html">range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/zeros.html">zeros</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/creation/tensors/index.html">Tensor Creation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/tensors/make.html">Making Tensors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/manipulation/index.html">Manipulation Functions</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/basic/index.html">Basic Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/copy.html">copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/if.html">IF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/ifelse.html">IFELSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/permute.html">permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/slice.html">slice</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/joinrepeat/index.html">Joining and Repeating</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/clone.html">clone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/concat.html">concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/flatten.html">flatten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/lcollapse.html">lcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/rcollapse.html">rcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/repmat.html">repmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/stack.html">stack</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/rearranging/index.html">Rearranging</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/fliplr.html">fliplr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/flipud.html">flipud</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/reshape.html">reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/reverse.html">reverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/shift.html">shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/transpose.html">transpose</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/selecting/index.html">Selecting</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/reduce.html">reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/remap.html">remap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/select.html">select</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/io/index.html">Input/Output</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/io/read_csv.html">read_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/read_mat.html">read_mat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/write_csv.html">write_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/write_mat.html">write_mat</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/math/index.html">Mathematical Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/arithmetic/index.html">Arithmetic Operations</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/add.html">Addition (+)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/div.html">Divide (/)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/fmod.html">fmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/mod.html">Modulo (%)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/mul.html">Multiply (*)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/neg.html">Negate (-)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/pow.html">pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/sub.html">Subtract (-)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/complex/index.html">Complex Numbers</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/angle.html">angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/conj.html">conj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/hermitiant.html">hermitianT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/imag.html">imag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/norm.html">norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/real.html">real</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/explog/index.html">Exponents and Logarithms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/exp.html">exp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/expj.html">expj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log.html">log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log10.html">log10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log2.html">log2</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/extrema/index.html">Extrema Finding</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/max.html">max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/min.html">min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/rmax.html">rmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/rmin.html">rmin</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/misc/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/abs.html">abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/softmax.html">softmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/sqrt.html">sqrt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/round/index.html">Rounding</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/ceil.html">ceil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/floor.html">floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/round.html">round</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/sumprod/index.html">Sums, Products, and Differences</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/cumsum.html">cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/prod.html">prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/sum.html">sum</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/trig/index.html">Trigonometric Functions</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/acos.html">acos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/acosh.html">acosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/asin.html">asin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/asinh.html">asinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/atan.html">atan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/atanh.html">atanh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cart2sph.html">cart2sph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cos.html">cos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cosh.html">cosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sin.html">sin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sinh.html">sinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sph2cart.html">sph2cart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/tan.html">tan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/tanh.html">tanh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/linalg/index.html">Linear Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/decomp/index.html">Decompositions</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/chol.html">chol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/inverse.html">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/lu.html">lu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/qr.html">qr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svd.html">svd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svdbpi.html">svdbpi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svdpi.html">svdpi</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/eigenvalues/index.html">Eigenvalues and Eigenvectors</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/eigenvalues/eig.html">eig</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/matvec/index.html">Matrix and Vector Products</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/einsum.html">einsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/kron.html">kron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/matmul.html">matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/matvec.html">matvec</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/other/index.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/other/cgsolve.html">cgsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/other/trace.html">trace</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/stats/index.html">Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/avgvar/index.html">Averages and Variances</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/mean.html">mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/median.html">median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/stdd.html">stdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/var.html">var</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/corr/index.html">Correlating</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/corr/corr.html">corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/corr/cov.html">cov</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/hist/index.html">Histograms</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/hist/hist.html">hist</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/searchsort/index.html">Searching and Sorting</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/argmax.html">argmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/argmin.html">argmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/find.html">find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/findidx.html">find_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/sort.html">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/unique.html">unique</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/logic/index.html">Logic Functions</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/bitwise/index.html">Bitwise Operations</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/and.html">Bitwise AND (&amp;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/or.html">Bitwise OR (|)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/xor.html">Bitwise XOR (^)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/comparison/index.html">Comparison Operations</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/equal.html">Equal (==)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/gt.html">Greater than (&gt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/gte.html">Greater than or equal (&gt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/lt.html">Less than (&lt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/lte.html">Less than or equal (&lt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/neq.html">Not-equal (!=)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/logical/index.html">Logical Operations</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/and.html">&amp;&amp; (AND)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/not.html">! (NOT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/or.html">|| (OR)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/truth/index.html">Truth Value Testing</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/truth/all.html">all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/truth/any.html">any</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/casting/index.html">Casting Operators</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_double.html">as_double</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_float.html">as_float</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int16.html">as_int16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int32.html">as_int32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int8.html">as_int8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_type.html">as_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint16.html">as_uint16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint32.html">as_uint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint8.html">as_uint8</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/window/index.html">Windowing</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/window/bartlett.html">bartlett</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/blackman.html">blackman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/flattop.html">flattop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/hamming.html">hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/hanning.html">hanning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/signalimage/index.html">Signal and Image Processing</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/convolution/index.html">Convolution</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/convolution/conv1d.html">conv1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/convolution/conv2d.html">conv2d</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/filtering/index.html">Filtering</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/filtering/filter.html">filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/filtering/resample_poly.html">resample_poly</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/general/index.html">General</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/chirp.html">chirp</a></li>

<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/downsample.html">downsample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/upsample.html">upsample</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/radar/index.html">Radar</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/radar/ambgfun.html">ambgfun</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/radar/mvdr.html">MVDR</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/polynomials/index.html">Polynomials</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/polynomials/legendre.html">legendre</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/random/random.html">Random Number Generation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/dft/index.html">Discrete Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/dct/index.html">DCT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/dct/dct.html">dct</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/fft/index.html">FFT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/fft.html">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/fft2d.html">fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/ifft.html">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/ifft2.html">ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/r2c.html">r2c</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/utility/index.html">Utility Functions</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftfreq.html">fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftshift1d.html">fftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftshift2d.html">fftshift2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/ifftshift1d.html">ifftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/ifftshift2d.html">ifftshift2D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/viz/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/bar.html">bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/contour.html">contour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/line.html">line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/scatter.html">scatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/surf.html">surf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/type_traits.html">Type Traits</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Example Applications</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">FFT Convolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../limitations.html">Limitations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/fftconv.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FFT Convolution</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution">Execution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">Verification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="fft-convolution">
<h1>FFT Convolution<a class="headerlink" href="#fft-convolution" title="Permalink to this heading">#</a></h1>
<p>This example shows how to perform a convolution in the frequency domain using the convolution theorem:</p>
<div class="math notranslate nohighlight">
\[h*x \leftrightarrow H \cdot X\]</div>
<p>The output of the FFT convolution is verified against MatX’s built-in direct convolution to ensure the
results match.</p>
<p>The source code for this example can be found in examples/fft_conv.cu.</p>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<p>FFT convolution is generally preferred over direct convolution for sequences larger than a given size. This
size depends on the underlying hardware, but in general, a signal longer than a few thousand points will typically
be faster with an FFT convolution. However, FFT convolution requires setting up several intermediate buffers
that are not required for direct convolution. This is typically not a problem when the signal and filter size
are not changing since these can be allocated once on startup.</p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<p>The first step for FFT convolution is allocating the intermediate buffers needed for each stage of the convolution. Assuming
the input signal and filter are in the time domain, the required buffers are:</p>
<ol class="arabic simple">
<li><p>Time domain input signal of length M (signalTimeData)</p></li>
<li><p>Time domain input filter of length L (filterTimeData)</p></li>
<li><p>Time domain output filtered signal of length M + L - 1 (timeOutData)</p></li>
<li><p>Frequency domain input signal of length M + L - 1 (signalFreqData)</p></li>
<li><p>Frequency domain input filter of length M + L - 1 (filterFreqData)</p></li>
</ol>
<p>For this example the FFT size used is the same as the output signal length. Typically this may be rounded up to a
power of two FFT for performance reasons, but this example is not attempting to optimize for performance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Create</span> <span class="n">time</span> <span class="n">domain</span> <span class="n">buffers</span>
<span class="n">tensor_t</span><span class="o">&lt;</span><span class="nb">complex</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">sig_time</span><span class="p">({</span><span class="n">signal_size</span><span class="p">});</span>
<span class="n">tensor_t</span><span class="o">&lt;</span><span class="nb">complex</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">filt_time</span><span class="p">({</span><span class="n">filter_size</span><span class="p">});</span>
<span class="n">tensor_t</span><span class="o">&lt;</span><span class="nb">complex</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">time_out</span><span class="p">({</span><span class="n">filtered_size</span><span class="p">});</span>

<span class="o">//</span> <span class="n">Frequency</span> <span class="n">domain</span> <span class="n">buffers</span>
<span class="n">tensor_t</span><span class="o">&lt;</span><span class="nb">complex</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">sig_freq</span><span class="p">({</span><span class="n">filtered_size</span><span class="p">});</span>
<span class="n">tensor_t</span><span class="o">&lt;</span><span class="nb">complex</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">filt_freq</span><span class="p">({</span><span class="n">filtered_size</span><span class="p">});</span>
</pre></div>
</div>
<p>The next step initializes the data in both the signal and the filter to give reproducible results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Fill</span> <span class="n">the</span> <span class="n">time</span> <span class="n">domain</span> <span class="n">signals</span> <span class="k">with</span> <span class="n">data</span>
<span class="k">for</span> <span class="p">(</span><span class="n">index_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">signal_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sig_time</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">i</span><span class="o">%</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span><span class="n">f</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">((</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">i</span><span class="o">%</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.0</span><span class="n">f</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1</span><span class="n">f</span><span class="p">};</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="n">index_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">filter_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">filt_time</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">{(</span><span class="nb">float</span><span class="p">)</span><span class="n">i</span><span class="o">/</span><span class="n">filter_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="o">/</span><span class="n">filter_size</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">f</span><span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that both <code class="docutils literal notranslate"><span class="pre">sig_time</span></code> and <code class="docutils literal notranslate"><span class="pre">filt_time</span></code> are views on the data objects using operator() to assign values on the host.</p>
<p>Once the data is initialized, we prefetch it onto the device to avoid the page fault when the kernel is launched:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Prefetch</span> <span class="n">the</span> <span class="n">data</span> <span class="n">we</span> <span class="n">just</span> <span class="n">created</span>
<span class="n">sig_time</span><span class="o">.</span><span class="n">PrefetchDevice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">filt_time</span><span class="o">.</span><span class="n">PrefetchDevice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>Since the expected output size of the full filtering operation is signal_len + filter_len - 1, both the filter and
signal time domain inputs are shorter than the output. This would normally require a separate stage of allocating buffers
of the appropriate size, zeroing them out, copying the time domain data to the buffers, and performing the FFT. However, MatX
has an API to do all of this automatically in the library using asynchronous allocations. This makes the call have a noticeable
performance hit on the first call, but subsequent calls will be close to the time without allocation.</p>
<p>To recognize that automatic padding is wanted, MatX uses the output tensor size compared to the input tensor size to determine
whether to pad the input with zeros. In this case the output signal (sig_time and filt_time) are shorter than the output tensors
(sig_freq and filt_freq), so it will automatically zero-pad the input.</p>
</section>
<section id="execution">
<span id="id1"></span><h2>Execution<a class="headerlink" href="#execution" title="Permalink to this heading">#</a></h2>
<p>With the setup complete, the actual convolution can be performed by an FFT, element-wise multiply, then IFFT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Perform</span> <span class="n">the</span> <span class="n">FFT</span> <span class="ow">in</span><span class="o">-</span><span class="n">place</span> <span class="n">on</span> <span class="n">both</span> <span class="n">signal</span> <span class="ow">and</span> <span class="nb">filter</span>
<span class="n">fft</span><span class="p">(</span><span class="n">sig_freq</span><span class="p">,</span>  <span class="n">sig_freq</span><span class="p">);</span>
<span class="n">fft</span><span class="p">(</span><span class="n">filt_freq</span><span class="p">,</span> <span class="n">filt_freq</span><span class="p">);</span>

<span class="o">//</span> <span class="n">Perform</span> <span class="n">the</span> <span class="n">pointwise</span> <span class="n">multiply</span><span class="o">.</span> <span class="n">Overwrite</span> <span class="n">signal</span> <span class="n">buffer</span> <span class="k">with</span> <span class="n">result</span>
<span class="p">(</span><span class="n">sig_freq</span> <span class="o">=</span> <span class="n">sig_freq</span> <span class="o">*</span> <span class="n">filt_freq</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">();</span>

<span class="o">//</span> <span class="n">IFFT</span> <span class="ow">in</span><span class="o">-</span><span class="n">place</span>
<span class="n">ifft</span><span class="p">(</span><span class="n">sig_freq</span><span class="p">,</span> <span class="n">sig_freq</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that for the multiply we’re using the MatX multiply operator <cite>*</cite> that multiplies two tensors of equal size
and rank together, and stores the results in sig_freq. Because there is a 1:1 mapping of input and output elements,
there are no race conditions when writing into the same buffer.</p>
</section>
<section id="verification">
<h2>Verification<a class="headerlink" href="#verification" title="Permalink to this heading">#</a></h2>
<p>The last step is verifying the results against a direct convolution. The results will likely not be identical when comparing
directly using floating point numbers because of the different operations and ordering involved with FFT versus direct
convolution. Instead, we compare the values with a small enough epsilon (0.001) for the magnitude of our output data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Now</span> <span class="n">the</span> <span class="n">sig_freq</span> <span class="n">view</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">full</span> <span class="n">convolution</span> <span class="n">result</span><span class="o">.</span> <span class="n">Verify</span> <span class="n">against</span> <span class="n">a</span> <span class="n">direct</span> <span class="n">convolution</span>
<span class="n">matxDirectConv1D</span><span class="p">(</span><span class="n">time_out</span><span class="p">,</span> <span class="n">sig_time</span><span class="p">,</span> <span class="n">filt_time</span><span class="p">,</span> <span class="n">matxConvCorrMode_t</span><span class="p">::</span><span class="n">MATX_C_MODE_FULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="n">cudaStreamSynchronize</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="o">//</span> <span class="n">Compare</span> <span class="n">signals</span>
<span class="k">for</span> <span class="p">(</span><span class="n">index_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">filtered_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span>  <span class="n">fabs</span><span class="p">(</span><span class="n">time_out</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">-</span> <span class="n">sig_freq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="o">||</span>
        <span class="n">fabs</span><span class="p">(</span><span class="n">time_out</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span> <span class="o">-</span> <span class="n">sig_freq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Verification failed at item %lld. Direct=</span><span class="si">%f%+.2f</span><span class="s2">j, FFT=</span><span class="si">%f%+.2f</span><span class="s2">j</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span>
        <span class="n">time_out</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">(),</span> <span class="n">time_out</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span><span class="p">(),</span> <span class="n">sig_freq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">(),</span> <span class="n">sig_freq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span><span class="p">());</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>While this example showed a single FFT convolution, filtering is commonly performed on a streaming set of data. By preparing
all of the buffers ahead of time, only the <a class="reference internal" href="#execution"><span class="std std-ref">Execution</span></a> part of this example would need to be performed in the data path. This
allows for highly-optimized code using the simple syntax above.</p>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example Applications</p>
      </div>
    </a>
    <a class="right-next"
       href="../limitations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Limitations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution">Execution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">Verification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nvidia
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021, Nvidia.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
 
  <footer class="bd-footer">
  </footer>

  <style>
         .wy-nav-content { max-width: 1600px; }
         .wy-table-responsive table td, .wy-table-responsive table th {
            white-space: normal;
          }          
  </style>


  </body>
</html>