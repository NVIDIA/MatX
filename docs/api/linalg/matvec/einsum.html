

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>einsum &#8212; matx  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/linalg/matvec/einsum';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="kron" href="kron.html" />
    <link rel="prev" title="Matrix and Vector Products" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    <p class="title logo__title">matx  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MatX Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../build.html">Build Integration</a></li>



<li class="toctree-l1 has-children"><a class="reference internal" href="../../../basics/index.html">Basics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/broadcast.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/concepts.html">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/creation.html">Creating Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/datatype.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/fusion.html">Operator Fusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/matlabpython.html">MatX For MATLAB/NumPy Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/nvtx.html">NVTX Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/print.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basics/tensor.html">Tensor Type</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../creation/index.html">Creating Operators and Tensors</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../creation/operators/index.html">Creation Operators</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/alternate.html">alternate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/diag.html">diag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/eye.html">eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/linspace.html">linspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/logspace.html">logspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/meshgrid.html">meshgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/ones.html">ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/range.html">range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../creation/operators/zeros.html">zeros</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../creation/tensors/index.html">Tensor Creation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../creation/tensors/make.html">Making Tensors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../manipulation/index.html">Manipulation Functions</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../manipulation/basic/index.html">Basic Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/basic/copy.html">copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/basic/if.html">IF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/basic/ifelse.html">IFELSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/basic/slice.html">slice</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../manipulation/joinrepeat/index.html">Joining and Repeating</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/clone.html">clone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/concat.html">concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/flatten.html">flatten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/lcollapse.html">lcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/rcollapse.html">rcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/repmat.html">repmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/joinrepeat/stack.html">stack</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../manipulation/rearranging/index.html">Rearranging</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/fliplr.html">fliplr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/flipud.html">flipud</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/overlap.html">overlap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/permute.html">permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/reshape.html">reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/reverse.html">reverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/shift.html">shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/transpose.html">transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/rearranging/transpose_matrix.html">transpose_matrix</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../manipulation/selecting/index.html">Selecting</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/selecting/at.html">at</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/selecting/reduce.html">reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/selecting/remap.html">remap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../manipulation/selecting/select.html">select</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../io/index.html">Input/Output</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../io/read_csv.html">read_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/read_mat.html">read_mat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/write_csv.html">write_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/write_mat.html">write_mat</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../math/index.html">Mathematical Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/arithmetic/index.html">Arithmetic Operations</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/add.html">Addition (+)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/div.html">Divide (/)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/fmod.html">fmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/mod.html">Modulo (%)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/mul.html">Multiply (*)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/neg.html">Negate (-)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/pow.html">pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/arithmetic/sub.html">Subtract (-)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/complex/index.html">Complex Numbers</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/angle.html">angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/conj.html">conj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/hermitiant.html">hermitianT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/imag.html">imag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/norm.html">norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/complex/real.html">real</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/explog/index.html">Exponents and Logarithms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/explog/exp.html">exp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/explog/expj.html">expj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/explog/log.html">log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/explog/log10.html">log10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/explog/log2.html">log2</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/extrema/index.html">Extrema Finding</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/extrema/max.html">max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/extrema/min.html">min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/extrema/rmax.html">rmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/extrema/rmin.html">rmin</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/misc/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/misc/abs.html">abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/misc/softmax.html">softmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/misc/sqrt.html">sqrt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/round/index.html">Rounding</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/round/ceil.html">ceil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/round/floor.html">floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/round/round.html">round</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/sumprod/index.html">Sums, Products, and Differences</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/sumprod/cumsum.html">cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/sumprod/prod.html">prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/sumprod/sum.html">sum</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../math/trig/index.html">Trigonometric Functions</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/acos.html">acos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/acosh.html">acosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/asin.html">asin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/asinh.html">asinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/atan.html">atan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/atanh.html">atanh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/cart2sph.html">cart2sph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/cos.html">cos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/cosh.html">cosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/sin.html">sin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/sinh.html">sinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/sph2cart.html">sph2cart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/tan.html">tan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math/trig/tanh.html">tanh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">Linear Algebra</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../decomp/index.html">Decompositions</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../decomp/chol.html">chol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/inverse.html">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/lu.html">lu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/qr.html">qr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/svd.html">svd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/svdbpi.html">svdbpi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../decomp/svdpi.html">svdpi</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../eigenvalues/index.html">Eigenvalues and Eigenvectors</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../eigenvalues/eig.html">eig</a></li>
</ul>
</li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="index.html">Matrix and Vector Products</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l4 current active"><a class="current reference internal" href="#">einsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="kron.html">kron</a></li>
<li class="toctree-l4"><a class="reference internal" href="matmul.html">matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="matvec.html">matvec</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../other/index.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../other/cgsolve.html">cgsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../other/trace.html">trace</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../stats/index.html">Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../stats/avgvar/index.html">Averages and Variances</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/avgvar/mean.html">mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/avgvar/median.html">median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/avgvar/stdd.html">stdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/avgvar/var.html">var</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../stats/corr/index.html">Correlating</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/corr/corr.html">corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/corr/cov.html">cov</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../stats/hist/index.html">Histograms</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/hist/hist.html">hist</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../stats/misc/index.html">Misc</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/misc/percentile.html">percentile</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../searchsort/index.html">Searching and Sorting</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/argmax.html">argmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/argmin.html">argmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/find.html">find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/findidx.html">find_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/sort.html">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../searchsort/unique.html">unique</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../logic/index.html">Logic Functions</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../logic/bitwise/index.html">Bitwise Operations</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../logic/bitwise/and.html">Bitwise AND (&amp;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/bitwise/or.html">Bitwise OR (|)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/bitwise/xor.html">Bitwise XOR (^)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../logic/comparison/index.html">Comparison Operations</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/equal.html">Equal (==)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/gt.html">Greater than (&gt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/gte.html">Greater than or equal (&gt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/isclose.html">isclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/lt.html">Less than (&lt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/lte.html">Less than or equal (&lt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/comparison/neq.html">Not-equal (!=)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../logic/logical/index.html">Logical Operations</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../logic/logical/and.html">&amp;&amp; (AND)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/logical/not.html">! (NOT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/logical/or.html">|| (OR)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../logic/truth/index.html">Truth Value Testing</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../logic/truth/all.html">all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/truth/allclose.html">allclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logic/truth/any.html">any</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../casting/index.html">Casting Operators</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_double.html">as_double</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_float.html">as_float</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_int16.html">as_int16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_int32.html">as_int32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_int8.html">as_int8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_type.html">as_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_uint16.html">as_uint16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_uint32.html">as_uint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../casting/as_uint8.html">as_uint8</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../window/index.html">Windowing</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../window/bartlett.html">bartlett</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../window/blackman.html">blackman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../window/flattop.html">flattop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../window/hamming.html">hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../window/hanning.html">hanning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../signalimage/index.html">Signal and Image Processing</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../signalimage/convolution/index.html">Convolution</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/convolution/conv1d.html">conv1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/convolution/conv2d.html">conv2d</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../signalimage/filtering/index.html">Filtering</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/filtering/channelize_poly.html">channelize_poly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/filtering/filter.html">filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/filtering/resample_poly.html">resample_poly</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../signalimage/general/index.html">General</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/general/chirp.html">chirp</a></li>

<li class="toctree-l4"><a class="reference internal" href="../../signalimage/general/downsample.html">downsample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/general/pwelch.html">pwelch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/general/upsample.html">upsample</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../signalimage/radar/index.html">Radar</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/radar/ambgfun.html">ambgfun</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../signalimage/radar/mvdr.html">MVDR</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../polynomials/index.html">Polynomials</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../polynomials/legendre.html">legendre</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../random/random.html">Random Number Generation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dft/index.html">Discrete Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dft/dct/index.html">DCT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dft/dct/dct.html">dct</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dft/fft/index.html">FFT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dft/fft/fft.html">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/fft/fft2d.html">fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/fft/ifft.html">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/fft/ifft2.html">ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/fft/r2c.html">r2c</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../dft/utility/index.html">Utility Functions</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dft/utility/fftfreq.html">fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/utility/fftshift1d.html">fftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/utility/fftshift2d.html">fftshift2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/utility/ifftshift1d.html">ifftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dft/utility/ifftshift2d.html">ifftshift2D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../viz/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../viz/bar.html">bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../viz/contour.html">contour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../viz/line.html">line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../viz/scatter.html">scatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../viz/surf.html">surf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../type_traits.html">Type Traits</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/index.html">Example Applications</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-50"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/fftconv.html">FFT Convolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../limitations.html">Limitations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/api/linalg/matvec/einsum.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>einsum</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-contractions">Tensor Contractions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dot-product">Dot Product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gemm-generalized-matrix-multiply">GEMM (Generalized Matrix Multiply)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permute">Permute</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trace">Trace</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="einsum">
<span id="id1"></span><h1>einsum<a class="headerlink" href="#einsum" title="Permalink to this heading">#</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.2.3.</span></p>
</div>
<p>MatX provides an <code class="docutils literal notranslate"><span class="pre">einsum</span></code> function similar to the one found in NumPy. <code class="docutils literal notranslate"><span class="pre">einsum</span></code> allows
a brief syntax to express many different operations in an optimized manner. A non-exhaustive list
of <code class="docutils literal notranslate"><span class="pre">einsum</span></code> operations are:</p>
<ul class="simple">
<li><p>Tensor contractions</p></li>
<li><p>Matrix multiplies (GEMMs)</p></li>
<li><p>Inner products</p></li>
<li><p>Transposes</p></li>
<li><p>Reductions</p></li>
<li><p>Trace</p></li>
</ul>
<p>While many of these operations are possible using other methods in MatX, <code class="docutils literal notranslate"><span class="pre">einsum</span></code> typically has a
shorter syntax, and is sometimes more optimized than a direct version of the operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using einsum() requires a minimum of cuTENSOR 1.7.0 and cuTensorNet 23.03.0.20. These are downloaded
automatically as part of CMake, but for offline environments these versions are needed.</p>
</div>
<p>As of now, MatX only supports a limited set of <code class="docutils literal notranslate"><span class="pre">einsum</span></code> operations that would be supported in
the NumPy version. Specifically only tensor contractions, inner products, and GEMMs are supported
and tested at this time. MatX also does not support broadcast ‘…’ notation and has no plans to. While
the broadcast notation is useful for high-rank tensors, it doesn’t add any new features and
isn’t compatible in all expressions inside NumPy. We feel listing out the dimensions makes the
syntax more clear without giving up any features. Since <code class="docutils literal notranslate"><span class="pre">einsum</span></code> requires an output tensor parameter,
only <em>explicit</em> mode is supported using the <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> operator. This allows type and size checking on the
output tensor at the cost of extra verbosity.</p>
<p>For tensor contractions, MatX uses cuTENSOR and cuTensorNet as the optimized backend libraries. Since
neither of these libraries are included with CUDA, and not all users need <code class="docutils literal notranslate"><span class="pre">einsum</span></code> functionality, <code class="docutils literal notranslate"><span class="pre">einsum</span></code>
is an opt-in feature when configuring MatX. To add support, add the following CMake line:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>-DMATX_EN_CUTENSOR<span class="o">=</span>ON
</pre></div>
</div>
<p>Both cuTENSOR and cuTensorNet can have their location specified using <code class="docutils literal notranslate"><span class="pre">cutensor_DIR</span></code> and <code class="docutils literal notranslate"><span class="pre">cutensornet_DIR</span></code>,
respectively. If these are not specified, CMake will attempt to download both libraries from the internet. <code class="docutils literal notranslate"><span class="pre">einsum</span></code>
is inside the <code class="docutils literal notranslate"><span class="pre">cutensor</span></code> namespace in MatX to indicate that it’s an optional feature.</p>
<p>To perform a tensor contraction of two 3D tensors across a single dimension:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
<span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ijk,jil-&gt;kl&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
</pre></div>
</div>
<p>The letters in the <code class="docutils literal notranslate"><span class="pre">subscripts</span></code> argument are names given to each dimension. The letters are arbitrary, but the
dimensions being contracted must have matching letters. In this case, we’re contracting along the <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code>
dimensions of both tensor <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, resulting in an output tensor with dimensions <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">x</span> <span class="pre">l</span></code>. The tensor <code class="docutils literal notranslate"><span class="pre">c</span></code>
must match the output dimensions of <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">x</span> <span class="pre">l</span></code>, which are the third dimension of both <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> (5 x 2).</p>
<p>Like other features in MatX, <code class="docutils literal notranslate"><span class="pre">einsum</span></code> can take an in artbirary number of tensors with arbitrary ranks. Each tensor’s
dimensions are separated by <code class="docutils literal notranslate"><span class="pre">,</span></code> in the subscript list, and the actual tensors are enumerated at the end of the function.</p>
<p>The first time <code class="docutils literal notranslate"><span class="pre">einsum</span></code> runs a contraction of a certain signature it can take a long time to complete. this is
because cuTensorNet and cuTensor perform optimization heuristics for future contractions. The penalty is
only paid on the first call of input tensors with that signature, and subsequent calls will only perform the
contraction step.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>einsum’s permute capability is significantly faster than the permute operator and should be preferred when possible.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is currently is not supported with host-based executors (CPU)</p>
</div>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this heading">#</a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN4matx8cutensor6einsumEDaRKNSt6stringEDp3InT">
<span id="_CPPv3IDpEN4matx8cutensor6einsumERKNSt6stringEDp3InT"></span><span id="_CPPv2IDpEN4matx8cutensor6einsumERKNSt6stringEDp3InT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">InT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacematx_1_1cutensor_1ac9302a0a5f364c28d14e55c8eee031b1"></span><span class="pre">__MATX_INLINE__</span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">matx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cutensor</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">einsum</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">subscripts</span></span>, <a class="reference internal" href="#_CPPv4IDpEN4matx8cutensor6einsumEDaRKNSt6stringEDp3InT" title="matx::cutensor::einsum::InT"><span class="n"><span class="pre">InT</span></span></a><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ops</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN4matx8cutensor6einsumEDaRKNSt6stringEDp3InT" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Evaluates the Einstein summation on the operands. </p>
<p><a class="reference internal" href="#namespacematx_1_1cutensor_1ac9302a0a5f364c28d14e55c8eee031b1"><span class="std std-ref">einsum()</span></a> is a multi-purpose tool capable of performing various operations on tensors in a compact syntax. A non-exhaustive list of operations are: tensor contractions, GEMMs, dot products, and tranposes. Because einsum is extremely powerful, not all features are supported or tested in MatX yet. Currently only tensor contractions are tested. Other operations may work, but they’re not tested yet.</p>
<p>MatX uses a syntax very similar to NumPy’s einsum syntax: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html">https://numpy.org/doc/stable/reference/generated/numpy.einsum.html</a></p>
<p>Ellipses are not supported yet, but a variadic list of tensors for contraction is supported. The output operator ‘-&gt;’ is required in MatX currently, and serves to provide error checking on the output tensor size.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>InT</strong> – Types of input operators </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>subscripts</strong> – String containing Einstein notation of operation to perform </p></li>
<li><p><strong>ops</strong> – List of input operators </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<section id="tensor-contractions">
<h3>Tensor Contractions<a class="headerlink" href="#tensor-contractions" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">60</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">24</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>

<span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linspace</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">Shape</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="n">TypeParam</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linspace</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">b1</span><span class="p">.</span><span class="n">Shape</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="n">TypeParam</span><span class="p">)</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">(</span><span class="n">b1</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))).</span><span class="n">run</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a1</span><span class="p">.</span><span class="n">View</span><span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="p">.</span><span class="n">View</span><span class="p">({</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>

<span class="c1">// Perform a 3D tensor contraction</span>
<span class="p">(</span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;ijk,jil-&gt;kl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="dot-product">
<h3>Dot Product<a class="headerlink" href="#dot-product" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">60</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">60</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({});</span>
<span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">Shape</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">b1</span><span class="p">.</span><span class="n">Shape</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">).</span><span class="n">run</span><span class="p">();</span><span class="w"> </span>

<span class="c1">// Perform a dot product of b1 with itself and store in a1</span>
<span class="p">(</span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;i,i-&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="gemm-generalized-matrix-multiply">
<h3>GEMM (Generalized Matrix Multiply)<a class="headerlink" href="#gemm-generalized-matrix-multiply" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span><span class="w">    </span>
<span class="k">auto</span><span class="w"> </span><span class="n">c22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span><span class="w">   </span>
<span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">b2</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span><span class="w"> </span>

<span class="c1">// Perform a GEMM of a2 * b2. Compare results to traditional matmul call</span>
<span class="p">(</span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;mk,kn-&gt;mn&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">c22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matmul</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span><span class="w">    </span>
<span class="k">auto</span><span class="w"> </span><span class="n">c22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span><span class="w">   </span>
<span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">b2</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span><span class="w"> </span>

<span class="c1">// Perform a GEMM of a2 * b2 and store the results transposed</span>
<span class="p">(</span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;mk,kn-&gt;nm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="permute">
<h3>Permute<a class="headerlink" href="#permute" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
<span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span>

<span class="c1">// Permute a 4D tensor. This gives the same output as Permute, but is much faster</span>
<span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;ijkl-&gt;jlki&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">Permute</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">})).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="sum">
<h3>Sum<a class="headerlink" href="#sum" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matx</span><span class="o">::</span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">});</span>
<span class="n">a</span><span class="p">.</span><span class="n">SetVals</span><span class="p">({</span>
<span class="w">    </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">}</span>
<span class="p">});</span><span class="w">  </span>

<span class="k">auto</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matx</span><span class="o">::</span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">3</span><span class="p">});</span>
<span class="c1">// Sum the columns of &quot;a&quot;</span>
<span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matx</span><span class="o">::</span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;ij-&gt;j&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="trace">
<h3>Trace<a class="headerlink" href="#trace" title="Permalink to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c0_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({});</span>
<span class="k">auto</span><span class="w"> </span><span class="n">c0_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="n">TypeParam</span><span class="o">&gt;</span><span class="p">({});</span>
<span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">Shape</span><span class="p">())).</span><span class="n">run</span><span class="p">();</span>

<span class="c1">// Perform a GEMM of a2 * b2. Compare results to traditional matmul call</span>
<span class="p">(</span><span class="n">c0_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutensor</span><span class="o">::</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;ii-&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
<span class="p">(</span><span class="n">c0_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trace</span><span class="p">(</span><span class="n">a2</span><span class="p">)).</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Matrix and Vector Products</p>
      </div>
    </a>
    <a class="right-next"
       href="kron.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">kron</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-contractions">Tensor Contractions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dot-product">Dot Product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gemm-generalized-matrix-multiply">GEMM (Generalized Matrix Multiply)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permute">Permute</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum">Sum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trace">Trace</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nvidia
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021, Nvidia.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
 
  <footer class="bd-footer">
  </footer>

  <style>
         .wy-nav-content { max-width: 1600px; }
         .wy-table-responsive table td, .wy-table-responsive table th {
            white-space: normal;
          }          
  </style>


  </body>
</html>