

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Creating Tensors &#8212; matx  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'basics/creation';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Types" href="datatype.html" />
    <link rel="prev" title="Concepts" href="concepts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">matx  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MatX Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Build Integration</a></li>



<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Basics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="broadcast.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Creating Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="datatype.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="fusion.html">Operator Fusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlabpython.html">MatX For MATLAB/NumPy Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvtx.html">NVTX Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="print.html">Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tensor.html">Tensor Type</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/creation/index.html">Creating Operators and Tensors</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/creation/operators/index.html">Creation Operators</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/alternate.html">alternate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/diag.html">diag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/eye.html">eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/linspace.html">linspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/logspace.html">logspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/meshgrid.html">meshgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/ones.html">ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/range.html">range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/operators/zeros.html">zeros</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/creation/tensors/index.html">Tensor Creation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/creation/tensors/make.html">Making Tensors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/manipulation/index.html">Manipulation Functions</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/basic/index.html">Basic Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/copy.html">copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/if.html">IF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/ifelse.html">IFELSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/basic/slice.html">slice</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/joinrepeat/index.html">Joining and Repeating</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/clone.html">clone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/concat.html">concat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/flatten.html">flatten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/lcollapse.html">lcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/rcollapse.html">rcollapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/repmat.html">repmat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/joinrepeat/stack.html">stack</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/rearranging/index.html">Rearranging</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/fliplr.html">fliplr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/flipud.html">flipud</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/overlap.html">overlap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/permute.html">permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/reshape.html">reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/reverse.html">reverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/shift.html">shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/transpose.html">transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/rearranging/transpose_matrix.html">transpose_matrix</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation/selecting/index.html">Selecting</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/at.html">at</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/reduce.html">reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/remap.html">remap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/manipulation/selecting/select.html">select</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/io/index.html">Input/Output</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/io/read_csv.html">read_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/read_mat.html">read_mat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/write_csv.html">write_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/io/write_mat.html">write_mat</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/math/index.html">Mathematical Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/arithmetic/index.html">Arithmetic Operations</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/add.html">Addition (+)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/div.html">Divide (/)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/fmod.html">fmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/mod.html">Modulo (%)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/mul.html">Multiply (*)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/neg.html">Negate (-)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/pow.html">pow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/arithmetic/sub.html">Subtract (-)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/complex/index.html">Complex Numbers</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/angle.html">angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/conj.html">conj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/hermitiant.html">hermitianT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/imag.html">imag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/norm.html">norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/complex/real.html">real</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/explog/index.html">Exponents and Logarithms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/exp.html">exp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/expj.html">expj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log.html">log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log10.html">log10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/explog/log2.html">log2</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/extrema/index.html">Extrema Finding</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/max.html">max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/min.html">min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/rmax.html">rmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/extrema/rmin.html">rmin</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/misc/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/abs.html">abs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/softmax.html">softmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/misc/sqrt.html">sqrt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/round/index.html">Rounding</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/ceil.html">ceil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/floor.html">floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/round/round.html">round</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/sumprod/index.html">Sums, Products, and Differences</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/cumsum.html">cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/prod.html">prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/sumprod/sum.html">sum</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math/trig/index.html">Trigonometric Functions</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/acos.html">acos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/acosh.html">acosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/asin.html">asin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/asinh.html">asinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/atan.html">atan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/atanh.html">atanh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cart2sph.html">cart2sph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cos.html">cos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/cosh.html">cosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sin.html">sin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sinh.html">sinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/sph2cart.html">sph2cart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/tan.html">tan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/math/trig/tanh.html">tanh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/linalg/index.html">Linear Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/decomp/index.html">Decompositions</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/chol.html">chol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/inverse.html">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/lu.html">lu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/qr.html">qr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svd.html">svd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svdbpi.html">svdbpi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/decomp/svdpi.html">svdpi</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/eigenvalues/index.html">Eigenvalues and Eigenvectors</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/eigenvalues/eig.html">eig</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/matvec/index.html">Matrix and Vector Products</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/einsum.html">einsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/kron.html">kron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/matmul.html">matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/matvec/matvec.html">matvec</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg/other/index.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/other/cgsolve.html">cgsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/linalg/other/trace.html">trace</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/stats/index.html">Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/avgvar/index.html">Averages and Variances</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/mean.html">mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/median.html">median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/stdd.html">stdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/avgvar/var.html">var</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/corr/index.html">Correlating</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/corr/corr.html">corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/corr/cov.html">cov</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/hist/index.html">Histograms</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/hist/hist.html">hist</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/stats/misc/index.html">Misc</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stats/misc/percentile.html">percentile</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/searchsort/index.html">Searching and Sorting</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/argmax.html">argmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/argmin.html">argmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/find.html">find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/findidx.html">find_idx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/sort.html">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/searchsort/unique.html">unique</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/logic/index.html">Logic Functions</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/bitwise/index.html">Bitwise Operations</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/and.html">Bitwise AND (&amp;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/or.html">Bitwise OR (|)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/bitwise/xor.html">Bitwise XOR (^)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/comparison/index.html">Comparison Operations</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/equal.html">Equal (==)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/gt.html">Greater than (&gt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/gte.html">Greater than or equal (&gt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/isclose.html">isclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/lt.html">Less than (&lt;)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/lte.html">Less than or equal (&lt;=)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/comparison/neq.html">Not-equal (!=)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/logical/index.html">Logical Operations</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/and.html">&amp;&amp; (AND)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/not.html">! (NOT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/logical/or.html">|| (OR)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic/truth/index.html">Truth Value Testing</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/truth/all.html">all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/truth/allclose.html">allclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/logic/truth/any.html">any</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/casting/index.html">Casting Operators</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_double.html">as_double</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_float.html">as_float</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int16.html">as_int16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int32.html">as_int32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_int8.html">as_int8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_type.html">as_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint16.html">as_uint16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint32.html">as_uint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/casting/as_uint8.html">as_uint8</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/window/index.html">Windowing</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/window/bartlett.html">bartlett</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/blackman.html">blackman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/flattop.html">flattop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/hamming.html">hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/window/hanning.html">hanning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/signalimage/index.html">Signal and Image Processing</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/convolution/index.html">Convolution</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/convolution/conv1d.html">conv1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/convolution/conv2d.html">conv2d</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/filtering/index.html">Filtering</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/filtering/channelize_poly.html">channelize_poly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/filtering/filter.html">filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/filtering/resample_poly.html">resample_poly</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/general/index.html">General</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/chirp.html">chirp</a></li>

<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/downsample.html">downsample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/pwelch.html">pwelch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/general/upsample.html">upsample</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/signalimage/radar/index.html">Radar</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/radar/ambgfun.html">ambgfun</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signalimage/radar/mvdr.html">MVDR</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/polynomials/index.html">Polynomials</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/polynomials/legendre.html">legendre</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/random/random.html">Random Number Generation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/dft/index.html">Discrete Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/dct/index.html">DCT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/dct/dct.html">dct</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/fft/index.html">FFT Functions</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/fft.html">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/fft2d.html">fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/ifft.html">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/ifft2.html">ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/fft/r2c.html">r2c</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/dft/utility/index.html">Utility Functions</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftfreq.html">fftfreq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftshift1d.html">fftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/fftshift2d.html">fftshift2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/ifftshift1d.html">ifftshift1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/dft/utility/ifftshift2d.html">ifftshift2D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/viz/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/bar.html">bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/contour.html">contour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/line.html">line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/scatter.html">scatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/viz/surf.html">surf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/type_traits.html">Type Traits</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Example Applications</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-50"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/fftconv.html">FFT Convolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../limitations.html">Limitations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/basics/creation.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating Tensors</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quick-primer-on-matx-types">A Quick Primer On MatX Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-constructor">Tensor Constructor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matx-storage">MatX Storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-descriptors">Tensor Descriptors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-descriptors">Dynamic Descriptors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-descriptors">Static Descriptors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Creating Tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-variants">Make Variants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-class-members">Tensor Class Members</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-c-array-or-a-brace-enclosed-list">Creating From C Array Or a Brace-Enclosed list</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-a-conforming-shape">Creating From A Conforming Shape</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-a-descriptor">Creating From A Descriptor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-tensors">0-D Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-storage-descriptors-and-allocators">Custom Storage, Descriptors, and Allocators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#storage">Storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptors">Descriptors</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="creating-tensors">
<span id="creating"></span><h1>Creating Tensors<a class="headerlink" href="#creating-tensors" title="Permalink to this heading">#</a></h1>
<p>Basic construction of tensors in MatX is intended to be very simple with minimal parameters. This allows users of other languages
to pick up the syntax quickly without understanding the underlying architecture. While using the simple API provides good performance,
it lacks flexibility and can prevent your code from running at the highest performance possible. This document walks through the
different ways to construct tensors, and when you should use certain methods over others.</p>
<section id="a-quick-primer-on-matx-types">
<h2>A Quick Primer On MatX Types<a class="headerlink" href="#a-quick-primer-on-matx-types" title="Permalink to this heading">#</a></h2>
<p>The basic type of tensor used in most examples and tests is the <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> object. <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> is the highest-level tensor class, and
provides all of the abstractions for viewing and modifying data, holding storage, and any other metadata needed by a tensor. Because of
their relatively large size, <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> objects are not meant to be passed to GPU devices. In fact, doing so will lead to a compiler error
since <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> uses types that are not available on the device at this time.</p>
<p>Within a <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> there is an abstract object called <code class="docutils literal notranslate"><span class="pre">Storage</span></code> (more on that later), and another inherited class called <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code>.
<code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code> is a lightweight class containing only the minimum amount of member variables needed to access the data from a GPU kernel. Currently the
member variables are a tensor descriptor and a data pointer. Tensor descriptors will be covered later in this document.</p>
<p><code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code> also includes member functions for accessing and modifying the tensor. Examples are all <code class="docutils literal notranslate"><span class="pre">operator()</span></code> functions
(both const and non-const), helper functions for the shape (<code class="docutils literal notranslate"><span class="pre">Size()</span></code> and <code class="docutils literal notranslate"><span class="pre">Stride()</span></code>), and utilities for printing on the host. <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code>
is the type that is passed into GPU kernels, and only contains types that are compatible with CUDA. Furthermore, the total size of the <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code>
object is as small as possible since these objects can be replicated many times within a single complex expression. Reducing the size of
<code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code> allows for fastest memory accesses, smaller copies before a kernel launch, and makes extending the code easier.</p>
<p>To convert between a <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> and <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code> a type trait called <code class="docutils literal notranslate"><span class="pre">base_type</span></code> is available and is used like the following:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typename</span><span class="w"> </span><span class="nc">base_type</span><span class="o">&lt;</span><span class="n">I1</span><span class="o">&gt;::</span><span class="n">type</span><span class="w"> </span><span class="n">in1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="p">;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">in</span></code> is the <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> object and <code class="docutils literal notranslate"><span class="pre">in1_</span></code> will be a <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code>.</p>
</section>
<section id="tensor-constructor">
<h2>Tensor Constructor<a class="headerlink" href="#tensor-constructor" title="Permalink to this heading">#</a></h2>
<p>Where possible, tensors should always be created using <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code>. This abstracts the type away from the user should any template types
change in the future. The one exception to this is when tensors are used as class members (see below). When a tensor is created with the default
constructor it is in an uninitialized state. Any type of accesses to the tensor will result in undefined behavior, so it must be initialized
using <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> before using it.</p>
</section>
<section id="matx-storage">
<h2>MatX Storage<a class="headerlink" href="#matx-storage" title="Permalink to this heading">#</a></h2>
<p>Within the <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> class is an abstract template parameter called <code class="docutils literal notranslate"><span class="pre">Storage</span></code>. <code class="docutils literal notranslate"><span class="pre">Storage</span></code> objects are always created from a <code class="docutils literal notranslate"><span class="pre">basic_storage</span></code>
class, which provides all accessor functions common to the underlying storage. <code class="docutils literal notranslate"><span class="pre">basic_storage</span></code> can wrap raw pointers using the <code class="docutils literal notranslate"><span class="pre">raw_pointer_buffer</span></code>
class, smart pointers using the <code class="docutils literal notranslate"><span class="pre">smart_pointer_buffer</span></code> class, or any RAII object that provides the required interface. If no user-defined storage
is passed in, MatX will default to allocating a raw CUDA managed memory pointer, and back it using a <code class="docutils literal notranslate"><span class="pre">shared_ptr</span></code> for garbage collection.</p>
<p>When not using implicitly-allocated memory, the user is free to define the storage container type, allocator, and ownership semantics. The container
type requires const and non-const iterators, an allocate function (when applicable), a <code class="docutils literal notranslate"><span class="pre">data()</span></code> function to get the raw pointer, and a way to get
the size. Currently both <code class="docutils literal notranslate"><span class="pre">std::array</span></code> and <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> from the STL follow these semantics, as do both the raw and smart pointer MatX containers.</p>
<p>The allocator type is used when the user passes in a shape without a pointer to existing data. By default, the allocator will use <code class="docutils literal notranslate"><span class="pre">matx_allocator</span></code>,
which is a PMR-compatible allocator with stream semantics. The allocator is used for both allocation and deallocation when no user-provided pointer
is passed in and ownership semantics are requested. If a pointer is provided, only the deallocator is used when ownership semantics have been requested.</p>
<p>In general, creating a tensor allows you to choose ownership semantics with creation. By using the <code class="docutils literal notranslate"><span class="pre">owning</span></code> type, MatX will take ownership of the pointer
and deallocate memory when the last tensor using the memory goes out of scope. By using the <code class="docutils literal notranslate"><span class="pre">non_owning</span></code> type, MatX will use the pointer, but not
perform any reference counting or deallocations when out of scope.</p>
</section>
<section id="tensor-descriptors">
<h2>Tensor Descriptors<a class="headerlink" href="#tensor-descriptors" title="Permalink to this heading">#</a></h2>
<p>Tensor descriptors are a template type inside <code class="docutils literal notranslate"><span class="pre">tensor_impl_t</span></code> that provide information about the size and strides of the tensor. While descriptors
are a simple concept, the implementation can have a large impact on performance if not tuned properly. Both the sizes and strides of the tensor are
a template class supporting iterators to access the metadata directly, and utility functions for accessing and computing other values from the metadata.
Descriptors are commonly stored as <code class="docutils literal notranslate"><span class="pre">std::array</span></code> types given its compile-time features, but any class meeting the accessor properties can be used.</p>
<section id="dynamic-descriptors">
<h3>Dynamic Descriptors<a class="headerlink" href="#dynamic-descriptors" title="Permalink to this heading">#</a></h3>
<p>Dynamic descriptors use storage in memory to describe the shapes and strides of a tensor. They can have lower performance than static descriptors
since more memory accesses and offset calculations are needed when accessing tensors, but have higher flexibility given the data is only needed at runtime.</p>
<p>Dynamic descriptors should be used when either the sizes are not known at compile-time, or when interoperating with existing code. As mentioned in the
introduction, the descriptor size is very important for both kernel performance and launch time. For this reason, the data types used to store both the
shape and size can vary depending on the size of the tensor parameters. While shape and stride storage types must match in length, the underlying types
used to store them can be different. This is useful in scenarios where the shape can be expressed as a smaller type than the strides.</p>
</section>
<section id="static-descriptors">
<h3>Static Descriptors<a class="headerlink" href="#static-descriptors" title="Permalink to this heading">#</a></h3>
<p>If the shapes and strides are known at compile time, static descriptors should be used. Static descriptors compute and store the shape and strides in
constexpr variables, and provide constexpr functions to access both values. When used in a GPU kernel, calling either <code class="docutils literal notranslate"><span class="pre">Size()</span></code> or <code class="docutils literal notranslate"><span class="pre">Stride()</span></code> emits
an immediate rvalue that the compiler can use for address calculations. This removes all loads and complex pointer arithmetic that could affect the
runtime of a kernel</p>
</section>
</section>
<section id="id1">
<h2>Creating Tensors<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>With the tensor terminology out of the way, its time to discuss how to create tensors. If theres one thing to take from this article, its that you
should use <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> or <code class="docutils literal notranslate"><span class="pre">make_static_tensor</span></code> wherever possible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prefer <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> or <code class="docutils literal notranslate"><span class="pre">make_static_tensor</span></code> over constructing tensors directly</p>
</div>
<p>Using these helper functions has many benefits:</p>
<ul class="simple">
<li><p>They remove the need to specify the rank of a tensor in the template parameters</p></li>
<li><p>They abstract away many of the complex template types of creating a tensor directly</p></li>
<li><p>They hide potentially irrelevant types from the user</p></li>
</ul>
<p>All <code class="docutils literal notranslate"><span class="pre">make_</span></code>-style functions return a <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code> object with the template parameters deduced or created as part of the input arguments. <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code>
only has two required template parameters (type and rank). For simple cases where only implicitly-allocated memory is needed, the default constructor
will suffice. Some situations prevent using the <code class="docutils literal notranslate"><span class="pre">make_</span></code> functions, such as when a tensor variable is a class member variable. In this case the type of
the member variable must be specified in the member list. In these scenaries its expected that the user knows what they are doing and can handle
spelling out the types themselves. For examples of this, see the simple_radar_pipeline files.</p>
<p>All make functions take the data type as the first template parameter.</p>
<section id="make-variants">
<h3>Make Variants<a class="headerlink" href="#make-variants" title="Permalink to this heading">#</a></h3>
<p>There are currently 4 different variants of the <code class="docutils literal notranslate"><span class="pre">make_</span></code> helper functions:
- <code class="docutils literal notranslate"><span class="pre">make_</span></code> for creating a tensor with a dynamic descriptor and returning by value
- <code class="docutils literal notranslate"><span class="pre">make_static_</span></code> for creating a tensor with a static descriptor and returning by value
- <code class="docutils literal notranslate"><span class="pre">make_X_p</span></code> for creating a tensor with a dynamic descriptor and returning a pointer
- <code class="docutils literal notranslate"><span class="pre">make_static_X_p</span></code> for creating a tensor with a static descriptor and returning a pointer</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_p</span></code> variants return pointers allocated with <cite>new</cite> and are expected to be deleted by the caller when finished. Returning smart pointers would
have made this easier, but some users have their own smart pointer wrapper and wouldnt want to unpack the standard library versions.</p>
<p>Within each of these types, there are usually versions both with and without user-defined pointers. These forms are used when an existing device pointer
is passed to MatX rather than having the allocation done when the tensor is created.</p>
<p>Each of these 4 variants can be used with all of the construction types when applicable.</p>
</section>
<section id="tensor-class-members">
<h3>Tensor Class Members<a class="headerlink" href="#tensor-class-members" title="Permalink to this heading">#</a></h3>
<p>When creating a class that has tensors as member variables theres an issue with the <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> syntax above, in that it depends on
being able to use the <code class="docutils literal notranslate"><span class="pre">auto</span></code> keyword to deduce the type. Since type deduction is not possible with member variables, the type must be
declared in the variable list. Once declared, a special version of <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> can be used in the constructor or initialization function
of the class to create the tensor in-place. This allows the user to specify only the rank and type in the member list, and the size can be
specified at initialization without repeating the rank and type.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span>
<span class="w">        </span><span class="n">MyClass</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">make_tensor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="k">private</span><span class="o">:</span>
<span class="w">        </span><span class="n">tensor_t</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>In the example above <code class="docutils literal notranslate"><span class="pre">make_tensor</span></code> takes an existing tensor as input to construct it in-place. Allocation is only performed once during initialization
and not when the tensor is declared.</p>
</section>
<section id="creating-from-c-array-or-a-brace-enclosed-list">
<h3>Creating From C Array Or a Brace-Enclosed list<a class="headerlink" href="#creating-from-c-array-or-a-brace-enclosed-list" title="Permalink to this heading">#</a></h3>
<p>Tensors can be created using a C-style shape array from an lvalue, or a brace-enclosed list as an rvalue. The following call the same <code class="docutils literal notranslate"><span class="pre">make_</span></code> call:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">};</span>
<span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">);</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">});</span>
</pre></div>
</div>
<p>In the former case the array is an lvalue that can be modified in memory before calling, whereas the latter case uses rvalues. For 0D tensors an empty
braced list is required:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({});</span>
</pre></div>
</div>
<p>When the sizes are known at compile time the static version of <code class="docutils literal notranslate"><span class="pre">make_</span></code> should be used:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_static_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>
</div>
<p>Notice the sizes are now template parameters instead of function parameters. Both ways can be used interchangeable in MatX code, but the static version
can lead to higher performance.</p>
<p>Similarly, all variants can be called with a user-defined pointer:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">});</span><span class="w"> </span><span class="c1">// ptr is a valid device pointer</span>
</pre></div>
</div>
<p>All cases shown above use the default stride parameters. If the strides are not linear in memory, they can be passed in as well:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">strides</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1200</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span>
<span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">strides</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="creating-from-a-conforming-shape">
<h3>Creating From A Conforming Shape<a class="headerlink" href="#creating-from-a-conforming-shape" title="Permalink to this heading">#</a></h3>
<p>As mentioned in the descriptor section, any type that conforms to the shape semantics can be used inside of a descriptor, and can also be passed into the
<code class="docutils literal notranslate"><span class="pre">make_</span></code> functions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">};</span>
<span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="creating-from-a-descriptor">
<h3>Creating From A Descriptor<a class="headerlink" href="#creating-from-a-descriptor" title="Permalink to this heading">#</a></h3>
<p>Descriptors (both shapes and sizes) can be used to construct tensors. This is useful when taking an existing tensor descriptor and creating a new tensor from it:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">existingTensor</span><span class="p">.</span><span class="n">Descriptor</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">t</span></code> is now a tensor with the same shapes and strides of <code class="docutils literal notranslate"><span class="pre">existingTensor</span></code>.</p>
</section>
<section id="d-tensors">
<h3>0-D Tensors<a class="headerlink" href="#d-tensors" title="Permalink to this heading">#</a></h3>
<p>0-D tensors are different than higher ranks since they have no meaningful shape or strides, and therefor dont need those parameters. Empty versions of the
<code class="docutils literal notranslate"><span class="pre">make_</span></code> helpers existing to create these:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">t01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tensor</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="custom-storage-descriptors-and-allocators">
<h3>Custom Storage, Descriptors, and Allocators<a class="headerlink" href="#custom-storage-descriptors-and-allocators" title="Permalink to this heading">#</a></h3>
<p>Within most of the <code class="docutils literal notranslate"><span class="pre">make_</span></code> functions, there are choices in the template parameters for custom storage, descriptor, and allocator types.</p>
</section>
</section>
<section id="storage">
<h2>Storage<a class="headerlink" href="#storage" title="Permalink to this heading">#</a></h2>
<p>Storage types can be created by wrapping a container object in the <code class="docutils literal notranslate"><span class="pre">basic_storage</span></code> class. MatX has a container type built-in for both raw pointers and smart
pointers, but this can be extended to use any conforming container type. The <code class="docutils literal notranslate"><span class="pre">basic_storage</span></code> class does not know about any underlying data structures or ownership;
this is encapsulated inside of the template type <code class="docutils literal notranslate"><span class="pre">C</span></code>. For example, to create a custom storage object to wrap a raw pointer:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">raw_pointer_buffer</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">owning</span><span class="p">,</span><span class="w"> </span><span class="n">matx_allocator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">rp</span><span class="p">{</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">desc</span><span class="p">.</span><span class="n">TotalSize</span><span class="p">()</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">))};</span>
<span class="n">basic_storage</span><span class="o">&lt;</span><span class="k">decltype</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">rp</span><span class="p">)};</span>
</pre></div>
</div>
<p>The code above creates a new <code class="docutils literal notranslate"><span class="pre">raw_pointer_buffer</span></code> object with ownership semantics and the <code class="docutils literal notranslate"><span class="pre">matx_allocator</span></code> allocator. A constructor taking a pointer and a
size will not allocate any new data, but track the pointer internally using a smart pointer. If instead <code class="docutils literal notranslate"><span class="pre">non_owning</span></code> had been passed as a template parameter, the
pointer would not be tracked or freed. With the container created, the next line passes the container into a <code class="docutils literal notranslate"><span class="pre">basic_storage</span></code> object for use inside <code class="docutils literal notranslate"><span class="pre">tensor_t</span></code>.</p>
</section>
<section id="descriptors">
<h2>Descriptors<a class="headerlink" href="#descriptors" title="Permalink to this heading">#</a></h2>
<p>Creating a descriptor can be done by using any conforming descriptor type (See descriptor explanation above). Within MatX, <code class="docutils literal notranslate"><span class="pre">std::array</span></code> is used by default
when creating dynamic descriptors. Because of the variable size of the stride and shape, MatX provides helper types for creating descriptors of common types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_desc_cr_disi_dist&lt;RANK&gt;</span></code> for a dynamic descriptor with <code class="docutils literal notranslate"><span class="pre">index_t</span></code> strides and shapes. This is the default descriptor and can also be creating using the type
<code class="docutils literal notranslate"><span class="pre">DefaultDescriptor</span></code>. <code class="docutils literal notranslate"><span class="pre">index_t</span></code> is defined at compile-time, and defaults to 64-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_desc_cr_ds_t&lt;ShapeType,</span> <span class="pre">StrideType,</span> <span class="pre">RANK&gt;</span></code> a <code class="docutils literal notranslate"><span class="pre">std::array</span></code>-based descriptor with user-provided types</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_desc_cr_ds_32_32_t&lt;RANK&gt;</span></code> is a descriptor with 32-bit sizes and strides</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_desc_cr_ds_64_64_t&lt;RANK&gt;</span></code> is a descriptor with 64-bit sizes and strides</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_desc_cr_ds_32_64_t&lt;RANK&gt;</span></code> is a descriptor with 32-bit sizes and 64-bit strides</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">static_tensor_desc_t&lt;size_t</span> <span class="pre">I,</span> <span class="pre">Size_t</span> <span class="pre">Is...&gt;</span></code> is a static-sized descriptor with the shape and stride created at compile time</p></li>
</ul>
<p>To create a descriptor:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="n">index_t</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">};</span>
<span class="n">DefaultDescriptor</span><span class="o">&lt;</span><span class="n">RANK</span><span class="o">&gt;</span><span class="w"> </span><span class="n">desc</span><span class="p">{</span><span class="n">arr</span><span class="p">};</span>
</pre></div>
</div>
<p>In this case we create a default descriptor (based on <code class="docutils literal notranslate"><span class="pre">index_t</span></code> sizes) using a C-style array.</p>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="concepts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Concepts</p>
      </div>
    </a>
    <a class="right-next"
       href="datatype.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Types</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-quick-primer-on-matx-types">A Quick Primer On MatX Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-constructor">Tensor Constructor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matx-storage">MatX Storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-descriptors">Tensor Descriptors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-descriptors">Dynamic Descriptors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-descriptors">Static Descriptors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Creating Tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-variants">Make Variants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-class-members">Tensor Class Members</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-c-array-or-a-brace-enclosed-list">Creating From C Array Or a Brace-Enclosed list</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-a-conforming-shape">Creating From A Conforming Shape</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-from-a-descriptor">Creating From A Descriptor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-tensors">0-D Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-storage-descriptors-and-allocators">Custom Storage, Descriptors, and Allocators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#storage">Storage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptors">Descriptors</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nvidia
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2021, Nvidia.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
 
  <footer class="bd-footer">
  </footer>

  <style>
         .wy-nav-content { max-width: 1600px; }
         .wy-table-responsive table td, .wy-table-responsive table th {
            white-space: normal;
          }          
  </style>


  </body>
</html>